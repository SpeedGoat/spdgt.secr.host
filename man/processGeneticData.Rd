% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mcmc_SMR.R
\name{processGeneticData}
\alias{processGeneticData}
\title{Process Genetic Data with Marking Status}
\usage{
processGeneticData(
  M,
  ncat,
  n_marked,
  G_marked,
  ID,
  G_use,
  IDcovs,
  gamma,
  useUnk = FALSE,
  useMarkednoID = FALSE
)
}
\arguments{
\item{M}{Integer. Total number of individuals in the population to be processed.}

\item{ncat}{Integer. Number of genetic categories or markers being analyzed.}

\item{n_marked}{Integer. Number of marked individuals in the dataset.}

\item{G_marked}{Matrix. Genetic data for marked individuals, with dimensions n_marked Ã— ncat.}

\item{ID}{Vector. Individual identifiers corresponding to the genetic observations.}

\item{G_use}{Matrix. Observed genetic data to be processed, with rows corresponding to observations.}

\item{IDcovs}{List. List of possible values for each genetic category.}

\item{gamma}{List. List of probability vectors for sampling missing genetic values.}

\item{useUnk}{Logical. If TRUE, handles unknown individuals differently. Default is FALSE.}

\item{useMarkednoID}{Logical. If TRUE, processes marked individuals without IDs. Default is FALSE.}
}
\value{
A list containing:
\itemize{
\item G_true: Matrix of processed genetic data for all individuals
\item G_use: Matrix of observed genetic data (potentially modified)
\item Mark_obs: Vector of marking status (if useUnk or useMarkednoID is TRUE)
\item G_latent: Logical matrix indicating which genetic values were initially missing
}
}
\description{
Processes genetic data while accounting for marking status and ID information. This function
handles genetic markers for both marked and unmarked individuals, consolidates multiple
observations per individual, and can impute missing genetic data based on provided probability
distributions.
}
\details{
The function performs several key operations:
\enumerate{
\item Initializes a matrix for true genetic values using marked individual data
\item Consolidates multiple observations per individual by taking the maximum value
\item Handles special cases for unknown or unmarked individuals
\item Imputes missing genetic data using provided probability distributions
\item Ensures output consistency regardless of input dimensions
}

When useUnk or useMarkednoID is TRUE, the function treats the last column of genetic
data as marking status and processes it separately.
}
\examples{
\dontrun{
# Basic usage with marked individuals only
M <- 10
ncat <- 3
n_marked <- 5
G_marked <- matrix(c(1,2,1, 2,1,2, 1,1,1, 2,2,2, 1,2,2), nrow=5, ncol=3, byrow=TRUE)
ID <- c(1,1,2,3,4,5)
G_use <- matrix(c(1,2,1, 1,2,1, 2,1,2, 1,1,1, 2,2,2, 1,2,2), nrow=6, ncol=3, byrow=TRUE)
IDcovs <- list(c(1,2), c(1,2), c(1,2))
gamma <- list(c(0.5,0.5), c(0.5,0.5), c(0.5,0.5))

result <- processGeneticData(M, ncat, n_marked, G_marked, ID, G_use, IDcovs, gamma)
}
}
