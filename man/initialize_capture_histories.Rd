% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mcmc_SMR.R
\name{initialize_capture_histories}
\alias{initialize_capture_histories}
\title{Initialize Capture Histories for Spatial Capture-Recapture}
\usage{
initialize_capture_histories(
  y_sight_latent,
  y_sight_true,
  y_sight_marked,
  y_mark = NULL,
  status,
  ID,
  M,
  n_marked,
  n_samp_latent,
  X1,
  X2,
  G_marked,
  G_marked_noID,
  constraints,
  Kconstraints,
  useMarkednoID = TRUE,
  markedS
)
}
\arguments{
\item{y_sight_latent}{Array. Latent capture histories from sighting data.}

\item{y_sight_true}{Array. True capture histories to be initialized.}

\item{y_sight_marked}{Array. Capture histories for marked individuals.}

\item{y_mark}{Array. Optional. Marking capture histories.}

\item{status}{Vector. Status indicator for each capture (1 for marked, 0 for unmarked).}

\item{ID}{Vector. Individual identifiers to be initialized.}

\item{M}{Integer. Maximum number of individuals in the population.}

\item{n_marked}{Integer. Number of marked individuals.}

\item{n_samp_latent}{Integer. Number of latent samples.}

\item{X1}{Matrix. Coordinates of marking locations.}

\item{X2}{Matrix. Coordinates of sighting locations.}

\item{G_marked}{Matrix. Genetic data for marked individuals.}

\item{G_marked_noID}{Matrix. Genetic data for marked individuals without IDs.}

\item{constraints}{Matrix. Binary matrix indicating compatible sample pairs.}

\item{Kconstraints}{Matrix. Additional constraints for sample assignment.}

\item{useMarkednoID}{Logical. Whether to process marked individuals without IDs. Default is TRUE.}

\item{markedS}{Vector. Status indicators for marked samples.}
}
\value{
A list containing:
\itemize{
\item y_sight_true: Array of initialized true capture histories
\item ID: Vector of assigned individual identifiers
}
}
\description{
Initializes and processes spatial capture-recapture histories by assigning
observations to individuals, handling both marked and unmarked individuals,
and managing spatial constraints. The function processes observations in two
passes: first for unmarked individuals, then for marked individuals with
unknown IDs.
}
\details{
The function performs initialization in multiple steps:
\enumerate{
\item Validates input arrays
\item Processes unmarked and unknown samples:
\itemize{
\item Identifies detection locations
\item Finds candidates caught at same locations
\item Applies spatial and genetic constraints
}
\item Processes marked individuals with unknown IDs:
\itemize{
\item Calculates mean locations for marked individuals
\item Checks genetic compatibility
\item Assigns based on spatial proximity
}
\item Validates final assignments against constraints
}
}
