% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mcmc_SMR.R
\name{combine_genetic_data}
\alias{combine_genetic_data}
\title{Combine Genetic Data with Different Observation Types}
\usage{
combine_genetic_data(
  data,
  ncat = 0,
  nlevels = NULL,
  useUnk = FALSE,
  useMarkednoID = FALSE
)
}
\arguments{
\item{data}{List. A data structure containing the following components:
\itemize{
\item G_unmarked: Matrix of genetic data for unmarked individuals
\item G_marked: Matrix of genetic data for marked individuals
\item G_unk: Optional matrix of genetic data for unknown status individuals
\item G_marked_noID: Optional matrix of genetic data for marked individuals without IDs
\item y_sight_unmarked: Capture histories for unmarked individuals
\item y_sight_unk: Optional capture histories for unknown status individuals
\item y_sight_marked_noID: Optional capture histories for marked individuals without IDs
}}

\item{ncat}{Integer. Number of genetic categories/markers. Default is 0.}

\item{nlevels}{Vector. Number of levels for each genetic marker. Default is NULL.}

\item{useUnk}{Logical. Whether to include unknown status individuals. Default is FALSE.}

\item{useMarkednoID}{Logical. Whether to include marked individuals without IDs. Default is FALSE.}
}
\value{
A list containing:
\itemize{
\item G_use: Combined genetic data matrix
\item G_marked: Modified genetic data for marked individuals
\item y_sight_latent: Combined capture histories
\item ncat: Updated number of genetic categories
\item nlevels: Updated number of levels per category
\item status: Vector indicating status of each individual (NULL if neither useUnk nor useMarkednoID)
}
}
\description{
Combines genetic data from different observation types (marked, unmarked, unknown)
in capture-recapture studies. The function handles various combinations of data
types based on the specified parameters and validates data consistency across
different observation types.
}
\details{
The function performs the following operations:
\enumerate{
\item Input Validation:
\itemize{
\item Checks for required data components
\item Validates consistency between genetic data and capture histories
\item Ensures matching dimensions across matrices
}
\item Data Combination:
\itemize{
\item Combines data based on useUnk and useMarkednoID parameters
\item Handles three scenarios:
\itemize{
\item Unknown status only (useUnk = TRUE, useMarkednoID = FALSE)
\item Marked without ID only (useUnk = FALSE, useMarkednoID = TRUE)
\item Both types (useUnk = TRUE, useMarkednoID = TRUE)
}
\item Adds status column to genetic data when appropriate
}
}

Status codes in the output:
\itemize{
\item 0: Unknown status
\item 1: Marked
\item 2: Unmarked
}
}
\examples{
# Create example data
data <- list(
  G_unmarked = matrix(c(1,2,1, 2,1,2), nrow=2, ncol=3),
  G_marked = matrix(c(1,1,1, 2,2,2), nrow=2, ncol=3),
  G_unk = matrix(c(1,1,2), nrow=1, ncol=3),
  y_sight_unmarked = array(0, dim=c(2,3,4)),  # 2 unmarked, 3 traps, 4 occasions
  y_sight_unk = array(0, dim=c(1,3,4))        # 1 unknown, 3 traps, 4 occasions
)

# Combine data including unknown status individuals
result <- combine_genetic_data(
  data = data,
  ncat = 3,
  nlevels = c(2,2,2),
  useUnk = TRUE,
  useMarkednoID = FALSE
)

}
